{% extends "base.html" %}
{% load static %}
{% block content %}
<style>
   

    ul {
      display: flex;
      justify-content: space-between;
      align-items: center;
      list-style: none;
      padding: 0;
      margin: 0;
    }

    ul li {
      padding: 10px;
    }

    a {
      text-decoration: none;
      color: #868586;
    }

    .container1 {
      display: flex;
      flex-wrap: wrap;
      padding: 20px;
      justify-content: center;
      max-width: 1600px;
      margin: 0 auto;
      background-color: #fff;
    
    }
#close-button{
  width:25px;
  height:25px;
  border-radius:50%;
  background-color:#ff4500;
  top:10px;
  right:10px;
  position:fixed;
}

    .product-image {
      flex: 1;
      max-width: 600px;
      padding: 10px;
      margin-right:10px;
    }

    .product-image img {
      max-height: 325px;
      object-fit: cover;
      width: 100%;
      border-radius: 10px;
    }

    .product-details {
      flex: 1;
      max-width: 600px;
      padding: 10px;
    }

    .product-details p {
      color: #6f6e73;
      padding:8px;
    }

    .product-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
      padding:8px;
    }

    .product-description {
      margin-bottom: 20px;
      color: #666;
      font-size: 18px;
      line-height: 1.6;
    }

    .product-price {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
      color: #333;
      padding:8px;
    }

    .original-price {
      text-decoration: line-through;
      margin-left: 10px;
      font-weight: normal;
      color: #888;
    }

    .discount {
      background-color: #ffe6e6;
      color: #ff4500;
      font-weight: bold;
      padding: 5px;
      border-radius: 5px;
      margin-left: 10px;
    }

    .add-to-cart {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .quantity {
      display: flex;
      align-items: center;
      margin-right: 20px;
    }

    .quantity button {
      background-color: #f0f0f0;
      border: 1px solid #ccc;
      padding: 5px 10px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      color: #333;
      border-radius: 4px;
      transition: background-color 0.3s ease;
    }

    .quantity button:focus {
      outline: 2px solid #007BFF;
      outline-offset: 2px;
    }

    .quantity input {
      width: 40px;
      text-align: center;
      border: 1px solid #ddd;
      padding: 5px;
      margin: 0 10px;
      font-size: 16px;
      color: #333;
    }

    .add-to-cart button {
      background-color: #ff4500;
      color: white;
      border: none;
      padding: 10px 35px;
      cursor: pointer;
      font-size: 16px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    .add-to-cart button:focus {
      outline: 2px solid #007BFF;
      outline-offset: 2px;
    }

    .add-to-cart button:hover {
      background-color: #e43e00;
    }

    .thumbnails {
      display: flex;
      justify-content: space-around;
      margin-top: 10px;
    }

    .thumbnails img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      cursor: pointer;
      border-radius: 5px;
      transition: transform 0.3s ease;
      border: 1px solid transparent;
    }

    .thumbnails img:hover {
      transform: scale(1.1);
      border-color: #007BFF;
    }

    .thumbnails img:focus {
      outline: 2px solid #007BFF;
      outline-offset: 2px;
    }

    @media (max-width: 768px) {
      .container1 {
        flex-direction: column;
        padding: 10px;
      }

      .product-image,
      .product-details {
        max-width: 100%;
      }

      .add-to-cart {
        flex-direction: column;
        align-items: flex-start;
      }

      .add-to-cart button {
        width: 100%;
        margin-top: 10px;
      }

      .quantity {
        width: 100%;
        justify-content: space-between;
        margin-bottom: 10px;
      }
    }

    @media (max-width: 480px) {
     

      ul {
        flex-direction: column;
        align-items: center;
        padding: 10px;
      }

      ul li {
        padding: 5px 0;
      }

      .add-to-cart button {
        width: 100%;
      }
    }

    @media (max-width: 360px) {
      .product-title {
        font-size: 20px;
      }

      .product-description {
        font-size: 16px;
      }

      .product-price {
        font-size: 20px;
      }

      .thumbnails img {
        width: 80px;
        height: 80px;
      }
}
</style>

  <main class="container1" id="main" data-id="123">
        <section id="productImage"class="product-image">
            <img src="{{data.image.url}}" alt="Fall Limited Edition Sneakers" id="large-img">
          
            <div class="thumbnails">
                <img src="{{data.image.url}}" alt="Side view of Fall Limited Edition Sneakers" id="thumbfst">
                <img id="thumbsnd"src="{{data.image2.url}}" alt="Back view of Fall Limited Edition Sneakers">
                <img id="thumbtrd" src="{{data.image3.url}}" alt="Top view of Fall Limited Edition Sneakers">
                <img id="thumbfrt" src="{{data.image.url}}" alt="Sole view of Fall Limited Edition Sneakers">
            </div>
        </section>
        <section class="product-details" id="productDetails">
          <p>{{data.brand}}</p>
            <h1 class="product-title" id="productName">{{data.name}}</h1>
            <p class="product-description">
                {{data.desc}}
            </p>
            <div class="product-price" >
                Rs.{{data.mark_price}}
                <span class="original-price" id="productPrice">Rs.{{data.price}}</span>
                <span class="discount">{{data.discount_percentage}}%OFF</span>
            </div>
            <div class="add-to-cart">
                <label for="quantity" class="sr-only">Quantity</label>
                <div class="quantity">
                    <button aria-label="Decrease quantity" onclick="decreaseQuantity()">-</button>
                    <input type="text" id="quantity" value="0" aria-label="Product quantity">
                    <button aria-label="Increase quantity" id="increaseBtn"onclick="increaseQuantity()">+</button>
                </div>
                <button type="button" id="add" aria-label="Add to cart">
                  <i class="fa fa-cart-shopping" style="padding:10px;"></i>Add to cart</button>
            </div>
        </section>
    </main>

    <script>
        // Get references to HTML elements by their IDs
const large = document.getElementById('large-img');
const first = document.getElementById('thumbfst');
const second = document.getElementById('thumbsnd');
const third = document.getElementById('thumbtrd');
const fourth = document.getElementById('thumbfrt')
const container1 = document.getElementById('productImage')
const productDetails = document.getElementById('productDetails');
const header = document.getElementById('header')


// Function to change the layout of the product image container1

function imageChanger() {
  container1.style.flex = 'none';
  container1.style.justifyContent = "center";
  container1.style.alignItems = "center";
  // Hide the header and product details sections
  header.style.display = 'none'
  productDetails.style.display = 'none';
  console.log('success');
  
 // Event listener for closing the image view
  const close = document.createElement('div');
  close.id = 'close-button';

  container1.appendChild(close)
  close.addEventListener('click', function() {
    container1.style.flex = '1';
    container1.style.justifyContent = '';
    container1.style.alignItems = '';
    header.style.display = '';
    productDetails.style.display = '';
    container1.removeChild(close); // Remove the close button
  });


}
// Functions to change the large image source based on the thumbnail clicked
function firstchange() {
  large.src = "{{data.image.url}}"
}

function secondchange() {
  large.src = "{{data.image2.url}}"
}

function thirdchange() {
  large.src = "{{data.image3.url}}"
  console.log('success');
}

function fourthChange() {
  large.src = "{{data.image.url}}";
  console.log('success')

}
// Add event listeners for the large image and thumbnails
large.addEventListener('click', imageChanger);
first.addEventListener('click', firstchange);
second.addEventListener('click', secondchange);
third.addEventListener('click', thirdchange);
fourth.addEventListener('click', fourthChange);
// Variables for quantity control
const incrBtn = document.getElementById('increaseBtn')
const quantity = document.getElementById('quantity');
let index = 0;
// Function to increase the quantity of the product
function increaseQuantity() {
  index++;
  document.getElementById('quantity').value = index;
  console.log('increase')
}
// Function to decrease the quantity of the product
function decreaseQuantity() {
  if (index > 0) {
    index--;
    document.getElementById('quantity').value = index;
    console.log('decrease')
  }
};

// Add to Cart Functionality
const addCart = document.getElementById('add');

function addToCart() {
   // Display a temporary message confirming the addition to the cart
  const cartMessage = document.createElement('div');
  const message = document.createElement('p');
  cartMessage.id = 'cart-message';
  cartMessage.style.position = 'fixed';
  cartMessage.style.bottom = '20px';
  cartMessage.style.right = '20px';
  cartMessage.style.backgroundColor = '#28a745';
  cartMessage.style.color = 'white';
  cartMessage.style.padding = '10px';
  cartMessage.style.borderRadius = '5px';
  cartMessage.style.boxShadow = '0px 0px 10px rgba(0, 0, 0, 0.3)';
  cartMessage.style.zIndex = '1000';
  message.textContent = 'Successfully added to cart!';
  cartMessage.appendChild(message);
  document.body.appendChild(cartMessage);
 // Remove the message after 3 seconds
  setTimeout(() => {
    document.body.removeChild(cartMessage);
  }, 3000);

  // Add item to local storage 
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  const productElement = document.getElementById('main');
  const itemId = productElement.dataset.id; // Ensure the HTML element has a data-id attribute
  const itemName = document.getElementById('productName').textContent;
      const itemPriceElement = document.getElementById('productPrice');
    const itemPrice = itemPriceElement ? itemPriceElement.textContent : '0';
  const itemImage = document.getElementById('large-img').src
  const quantity = parseInt(document.getElementById('quantity').value, 10);
  const item = {
    id: itemId,
    name: itemName,
    price: itemPrice,
    image: itemImage,
    quantity: quantity

  };
  // make sure the item is there
  const existingItem = cart.find(i => i.id === itemId)
  if (existingItem) {
    existingItem.quantity += quantity // update the quantity
  } else {
    cart.push(item); // add  a new item
  }
 // Save the updated cart to local storage

  localStorage.setItem('cart', JSON.stringify(cart));
  console.log('cart:',cart)
}



// Event listener for adding items to the cart

addCart.addEventListener('click', addToCart);


// Function to get cart items from local storage

function getCartItems() {
  return JSON.parse(localStorage.getItem('cart') || []);

}
// Event listener for the cart icon click
const cartIcon=document.getElementById('cart-icon');
cartIcon.addEventListener('click',mycart);

// Function to render the cart items in a modal or fixed position element
function mycart() {
  // render the cart items
  console.log('clicked')
  const cartItems = getCartItems();
  const cartContainer = document.getElementById('main')
  console.log('got them ', cartItems)
// Create a container1 for the cart items
      const  cartcontainer = document.createElement('div');
        cartcontainer.id = 'cart-container1';
        cartcontainer.style.position = 'fixed';
        cartcontainer.style.top = '70px';
        cartcontainer.style.right = '10px';
        cartcontainer.style.backgroundColor = 'white';
        cartcontainer.style.padding = '20px';
        cartcontainer.style.color= 'black';
        cartcontainer.style.borderRadius = '10px';
        cartcontainer.style.boxShadow = '0px 0px 10px rgba(0, 0, 0, 0.3)';
        cartcontainer.style.zIndex = '1000';
        document.body.appendChild(cartcontainer);

  // for each item added create a n image name price and quantity
  cartItems.forEach(item => {

    const itemElement = document.createElement('div');

    const itemImage = document.createElement('img');
    itemImage.src = item.image;
    itemImage.alt = item.name;
    itemImage.style.width = '100px';
    itemImage.style.borderRadius='10px';
    itemImage.style.padding='8px';

    const itemPrice = document.createElement('p');
    // Function to extract numeric value from a price string with a dollar sign
    function parsePrice(priceString){
        // Remove any non-numeric characters (except for the decimal point)
      return parseFloat(priceString.replace(/[^0-9.]/g, ''))
    }
    // Convert item.price and item.quantity to numbers explicitly
    const price =parsePrice(item.price);
    
    itemPrice.textContent = 
      `Price : $${price * Number(item.quantity)}`
    ;
    itemPrice.style.padding='8px';
  
    const itemName = document.createElement('p');
    itemName.textContent = item.name
    itemName.style.padding='8px';
    const itemQuantity = document.createElement('p');
    itemQuantity.textContent =
      `Quantity: ${Number(item.quantity)}`;
   itemQuantity.style.padding='8px';
    // Append all elements to the item container1
    itemElement.appendChild(itemName);
    itemElement.appendChild(itemPrice);
    itemElement.appendChild(itemImage);
    itemElement.appendChild(itemQuantity)
    cartcontainer.appendChild(itemElement);
 console.log('item:', item);
  });
  setTimeout(()=>{
    
    document.body.removeChild(cartcontainer);
    
  },4000)
  
  
  // Check if the cartcontainer exists before trying to remove it
// cartIcon.addEventListener('click', function() {
//   const existingContainer = document.getElementById('cart-container1');
//   if (existingContainer) {
//     document.body.removeChild(existingContainer);
//   }
// });

  
}
</script>


{% endblock content %}
